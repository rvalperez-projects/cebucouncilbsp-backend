<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cebucouncilbsp.backend.repository.InstitutionRepository">


  <select id="findAllInstitutions" parameterType="map" resultType="com.cebucouncilbsp.backend.entity.InstitutionEntity">
    SELECT
      MINST.INSTITUTION_ID,
      MINST.INSTITUTION_NAME,
      MINST.ADDRESS,
      MINST.CONTACT_NUMBER,
      MINST.DISTRICT,
      MINST.AREA,
      MINST.CATEGORY_CODE
    FROM
      M_INSTITUTION MINST
  </select>

  <select id="findByInstitutionId" parameterType="map" resultType="com.cebucouncilbsp.backend.entity.InstitutionEntity">
    SELECT
      MINST.INSTITUTION_ID,
      MINST.INSTITUTION_NAME,
      MINST.ADDRESS,
      MINST.CONTACT_NUMBER,
      MINST.DISTRICT,
      MINST.AREA,
      MINST.CATEGORY_CODE
    FROM
      M_INSTITUTION MINST
    WHERE
      MINST.INSTITUTION_ID = #{institutionId,jdbcType=INTEGER}
  </select>

  <select id="findByArea" parameterType="map" resultType="com.cebucouncilbsp.backend.entity.InstitutionEntity">
    SELECT
      MINST.INSTITUTION_ID,
      MINST.INSTITUTION_NAME,
      MINST.ADDRESS,
      MINST.CONTACT_NUMBER,
      MINST.DISTRICT,
      MINST.AREA,
      MINST.CATEGORY_CODE
    FROM
      M_INSTITUTION MINST
    WHERE
      MINST.AREA = #{area,jdbcType=VARCHAR}
  </select>

  <insert id="insertInstitution" parameterType="com.cebucouncilbsp.backend.entity.InstitutionEntity">
    INSERT INTO
      M_USER
    <trim prefix="(" suffix=")" suffixOverrides=",">
      INSTITUTION_NAME,
      ADDRESS,
      CONTACT_NUMBER,
      DISTRICT,
      AREA,
      CATEGORY_CODE,
      CREATED_BY,
      CREATED_DATETIME,
      UPDATED_BY,
      UPDATED_DATETIME
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      #{institutionName,jdbcType=VARCHAR},
      #{address,jdbcType=VARCHAR},
      #{contactNumber,jdbcType=VARCHAR},
      #{district,jdbcType=VARCHAR},
      #{area,jdbcType=VARCHAR},
      #{categoryCode,jdbcType=VARCHAR},
      #{createdBy,jdbcType=VARCHAR},
      #{updatedBy,jdbcType=VARCHAR},
      #{creationDateTime,jdbcType=TIMESTAMP},
      #{updatedDateTime,jdbcType=TIMESTAMP}
    </trim>
    RETURNING INSTITUTION_ID
  </insert>

  <update id="updateInstitution" parameterType="com.cebucouncilbsp.backend.entity.InstitutionEntity">
    UPDATE
      M_USER
    <set>
      INSTITUTION_NAME = #{institutionName,jdbcType=VARCHAR},
      ADDRESS = #{address,jdbcType=VARCHAR},
      CONTACT_NUMBER = #{contactNumber,jdbcType=VARCHAR},
      DISTRICT = #{district,jdbcType=VARCHAR},
      AREA = #{area,jdbcType=VARCHAR},
      CATEGORY_CODE = #{categoryCode,jdbcType=VARCHAR},
      UPDATED_BY = #{updatedBy,jdbcType=VARCHAR},
      UPDATED_DATETIME = #{updatedDateTime,jdbcType=TIMESTAMP}
    </set>
    WHERE
      INSTITUTION_ID = #{institutionId,jdbcType=INTEGER}
  </update>

</mapper>
